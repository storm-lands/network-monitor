# Network Traffic Monitoring Tool

این ابزار برای مانیتورینگ ترافیک شبکه در سرورهای لینوکس طراحی شده است. با استفاده از این ابزار، می‌توانید ترافیک شبکه (آپلود و دانلود) را در چندین سرور مانیتور کنید و داده‌ها را در یک سرور اصلی ذخیره نمایید.

## ویژگی‌ها

- مانیتورینگ ترافیک شبکه با استفاده از `ifstat`
- ارسال داده‌ها به یک سرور اصلی
- ذخیره داده‌ها در دیتابیس SQLite
- رابط کاربری ترمینال ساده و کاربرپسند
- پشتیبانی از چندین سرور
- نصب خودکار وابستگی‌ها

## نیازمندی‌ها

- سیستم عامل لینوکس
- دسترسی sudo (برای نصب وابستگی‌ها)

## نصب

برای نصب این ابزار، کافی است دستور زیر را در ترمینال اجرا کنید:

```bash
curl -s https://raw.githubusercontent.com/yourusername/network-monitor/main/install.sh | bash
```

یا می‌توانید فایل `install.sh` را دانلود کرده و به صورت دستی اجرا کنید:

```bash
chmod +x install.sh
./install.sh
```

## استفاده

پس از نصب، برنامه به صورت خودکار اجرا می‌شود. اگر می‌خواهید بعداً آن را اجرا کنید، از دستور زیر استفاده کنید:

```bash
bash ~/.network_monitor/network_monitor.sh
```

### تنظیم سرور اصلی

1. در یکی از سرورها، گزینه "Set this server as Main Server" را انتخاب کنید.
2. در سرورهای دیگر، گزینه "Set another Main Server" را انتخاب کرده و آدرس IP سرور اصلی را وارد کنید.
3. در سرور اصلی، از منوی "Server List" برای اضافه کردن سرورهایی که می‌خواهید مانیتور کنید استفاده نمایید.
4. در سرورهای کلاینت، گزینه "Start Monitoring" را انتخاب کنید تا ارسال داده‌ها به سرور اصلی آغاز شود.
5. در سرور اصلی، گزینه "Start Saving Data to Database" را انتخاب کنید تا داده‌های دریافتی در دیتابیس ذخیره شوند.

## منوهای برنامه

### منوی سرور کلاینت

- **Server State**: نمایش وضعیت فعلی سرور و ترافیک شبکه
- **Set this server as Main Server**: تنظیم این سرور به عنوان سرور اصلی
- **Set another Main Server**: تنظیم یک سرور دیگر به عنوان سرور اصلی
- **Start/Stop Monitoring**: شروع یا توقف ارسال داده‌ها به سرور اصلی

### منوی سرور اصلی

- **Server State**: نمایش وضعیت سرور اصلی و سرورهای متصل
- **Server List**: مدیریت لیست سرورهایی که مانیتور می‌شوند
- **Start/Stop Saving Data to Database**: شروع یا توقف ذخیره داده‌ها در دیتابیس

## ساختار فایل‌ها

- `~/.network_monitor/network_monitor.sh`: اسکریپت اصلی
- `~/.network_monitor/main_server.py`: سرور API برای دریافت داده‌ها
- `~/.network_monitor/config.json`: فایل پیکربندی
- `~/.network_monitor/network_data.db`: دیتابیس SQLite

## نکات

- برنامه حتی پس از بسته شدن ترمینال به ارسال/دریافت داده‌ها ادامه می‌دهد.
- برای توقف کامل مانیتورینگ، از گزینه "Stop Monitoring" استفاده کنید.
- برای مشاهده لاگ‌های سرور اصلی، فایل `~/.network_monitor/main_server.log` را بررسی کنید.

## مشکلات رایج

### خطای دسترسی به پورت 5000

اگر با خطای "Port 5000 is already in use" مواجه شدید، مطمئن شوید که هیچ برنامه دیگری از این پورت استفاده نمی‌کند.

### خطای نصب وابستگی‌ها

اگر با مشکلی در نصب وابستگی‌ها مواجه شدید، می‌توانید آن‌ها را به صورت دستی نصب کنید:

```bash
sudo apt-get update
sudo apt-get install -y ifstat curl jq python3 python3-pip
pip3 install flask
```

## قرار دادن اسکریپت‌ها در گیت‌هاب

برای قرار دادن اسکریپت‌ها در گیت‌هاب و استفاده از لینک مستقیم در دستور curl، مراحل زیر را دنبال کنید:

1. یک حساب کاربری در [GitHub](https://github.com) ایجاد کنید (اگر ندارید).
2. یک مخزن (repository) جدید با نام `network-monitor` ایجاد کنید.
3. فایل‌های `install.sh`، `network_monitor.sh`، `main_server.py` و `README.md` را در مخزن آپلود کنید.
4. پس از آپلود، لینک مستقیم به فایل `install.sh` به صورت زیر خواهد بود:
   ```
   https://raw.githubusercontent.com/yourusername/network-monitor/main/install.sh
   ```
5. در این لینک، `yourusername` را با نام کاربری گیت‌هاب خود جایگزین کنید.

حالا می‌توانید این لینک را در دستور curl استفاده کنید تا کاربران بتوانند با یک دستور ساده، اسکریپت شما را نصب و اجرا کنند.

## لایسنس

این پروژه تحت لایسنس MIT منتشر شده است.